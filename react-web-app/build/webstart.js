(()=>{"use strict";var e,t={277:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function i(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,i)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.run=void 0;var s=a(n(504));if("undefined"!=typeof process){var i=process.on;process.on=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"uncaughtException"===e[0]?void 0:i.apply(process,e)}}function u(e,t){return r(this,void 0,void 0,(function(){var n,r,a,i,u,c;return o(this,(function(o){switch(o.label){case 0:return[4,(0,s.default)()];case 1:return n=o.sent(),r=t.importObject,a=n.parseWat("test.wat",e),i=a.toBinary({}),[4,WebAssembly.instantiate(i.buffer,r)];case 2:return u=o.sent(),c=u.instance.exports.exported_func(),console.log("Memory",u.instance.exports.memory),[2,c]}}))}))}t.run=function(e,t,n){return r(this,void 0,void 0,(function(){var r,a,s,i,c,l,p,d;return o(this,(function(o){switch(o.label){case 0:return r={input:JSON.stringify({program:e}),stateMachineArn:"arn:aws:states:us-west-2:078212600544:stateMachine:Wathon"},[4,fetch("https://l07eno817e.execute-api.us-west-2.amazonaws.com/delta/execution",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}})];case 1:return[4,o.sent().json()];case 2:a=o.sent(),console.log("execution output",a),s={executionArn:a.executionArn},o.label=3;case 3:return[4,fetch("https://l07eno817e.execute-api.us-west-2.amazonaws.com/delta/desc",{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}})];case 4:return[4,o.sent().json()];case 5:i=o.sent(),o.label=6;case 6:if("RUNNING"===i.status)return[3,3];o.label=7;case 7:return c=JSON.parse(i.output),console.log("Final Wasm code:\n"+c),[4,u(c,n)];case 8:return l=o.sent(),p={program:e},[4,fetch("http://ec2-52-39-168-9.us-west-2.compute.amazonaws.com:3000/",{method:"POST",body:JSON.stringify(p),headers:{"Content-Type":"application/json"}})];case 9:return[4,o.sent().text()];case 10:return[4,u(o.sent(),t)];case 11:return[2,{server:d=o.sent(),serverless:l,compare:l===d}]}}))}))}},504:e=>{e.exports=wabt}},n={};e=function e(r){var o=n[r];if(void 0!==o)return o.exports;var a=n[r]={exports:{}};return t[r].call(a.exports,a,a.exports,e),a.exports}(277),document.addEventListener("DOMContentLoaded",(function(){function t(e){console.log("arg in displayServer",e);var t=document.createElement("pre");document.getElementById("serverCompileOutput").appendChild(t),t.innerText=e}function n(e){console.log("arg in displayServerless",e);var t=document.createElement("pre");document.getElementById("serverlessCompileOutput").appendChild(t),t.innerText=e}var r={importObject:{imports:{print:function(e){console.log("Logging from WASM: ",e);var t=document.createElement("pre");return document.getElementById("output").appendChild(t),t.innerText=e,e},print_num:function(e){return console.log("Logging from WASM: ",e),t(String(e)),0},print_bool:function(e){return t(0===e?"False":"True"),0},print_none:function(e){return t("None"),e},abs:Math.abs,max:Math.max,min:Math.min,pow:Math.pow}}},o={importObject:{imports:{print:function(e){console.log("Logging from WASM: ",e);var t=document.createElement("pre");return document.getElementById("output").appendChild(t),t.innerText=e,e},print_num:function(e){return console.log("Logging from WASM: ",e),n(String(e)),0},print_bool:function(e){return 0===e?t("False"):n("True"),0},print_none:function(e){return n("None"),e},abs:Math.abs,max:Math.max,min:Math.min,pow:Math.pow}}};document.getElementById("run").addEventListener("click",(function(t){var n=document.getElementById("user-code");(0,e.run)(n.value,r,o).then((function(e){!function(e){if(e.server){var t=document.createElement("pre");document.getElementById("serverCompileOutput").appendChild(t),t.innerText=e.server}e.serverless&&(t=document.createElement("pre"),document.getElementById("serverlessCompileOutput").appendChild(t),t.innerText=e.serverless),document.getElementById("comparison").innerHTML="<strong> Fidelity verification: </strong>"+(e.compare?'<span style="color:green">Passed</span>':'<span style="color:red">Failed</span>')}(e),console.log("run finished")})).catch((function(e){var t,n;t=e,n=document.createElement("pre"),document.getElementById("output").appendChild(n),n.setAttribute("style","color: red"),n.innerText=String(t),console.log("run failed",e)}))}));var a=document.querySelector("textarea");a.addEventListener("keydown",(function(e){9===e.keyCode&&(e.preventDefault(),a.setRangeText("  ",a.selectionStart,a.selectionStart,"end"))}))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFlLE9BQU9MLGlCQUFpQixTQUFTLFNBQVVzQixHQUNqRSxJQUFNNUQsRUFBU3FDLFNBQVNNLGVBQWUsY0FDdkMsSUFBQWtCLEtBQUk3RCxFQUFPOEQsTUFBT2YsRUFBb0JZLEdBQXdCSSxNQUFLLFNBQUNDLElBeEJ0RSxTQUFzQnZFLEdBQ3BCLEdBQUlBLEVBQU8rQixPQUFRLENBQ2pCLElBQU1pQixFQUFNSixTQUFTSyxjQUFjLE9BQ25DTCxTQUFTTSxlQUFlLHVCQUF1QkMsWUFBWUgsR0FDM0RBLEVBQUlJLFVBQVlwRCxFQUFPK0IsTSxDQUVyQi9CLEVBQU9pQyxhQUNIZSxFQUFNSixTQUFTSyxjQUFjLE9BQ25DTCxTQUFTTSxlQUFlLDJCQUEyQkMsWUFBWUgsR0FDL0RBLEVBQUlJLFVBQVlwRCxFQUFPaUMsWUFFTlcsU0FBU00sZUFBZSxjQUNoQ3NCLFVBQVksNkNBQStDeEUsRUFBT2tDLFFBQVEsMENBQTBDLHdDQUNqSSxDQVc4RXVDLENBQWFGLEdBQUluRSxRQUFRQyxJQUFJLGVBQWdCLElBQ3RIcUUsT0FBTSxTQUFDUCxHQVZaLElBQXFCbkUsRUFDYmdELEVBRGFoRCxFQVVXbUUsRUFUeEJuQixFQUFNSixTQUFTSyxjQUFjLE9BQ25DTCxTQUFTTSxlQUFlLFVBQVVDLFlBQVlILEdBQzlDQSxFQUFJMkIsYUFBYSxRQUFTLGNBQzFCM0IsRUFBSUksVUFBWU0sT0FBTzFELEdBTVdJLFFBQVFDLElBQUksYUFBYzhELEVBQUcsR0FDakUsSUFDQSxJQUFNUyxFQUFXaEMsU0FBU2lDLGNBQWMsWUFFeENELEVBQVMvQixpQkFBaUIsV0FBVyxTQUFDc0IsR0FDbEIsSUFBZEEsRUFBRVcsVUFDSlgsRUFBRVksaUJBRUZILEVBQVNJLGFBQ1AsS0FDQUosRUFBU0ssZUFDVEwsRUFBU0ssZUFDVCxPQUdOLEdBQ0YsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYi1hc20taml0Ly4vd2Vic3RhcnQudHMiLCJ3ZWJwYWNrOi8vd2ViLWFzbS1qaXQvLi9ydW5uZXIudHMiLCJ3ZWJwYWNrOi8vd2ViLWFzbS1qaXQvZXh0ZXJuYWwgdmFyIFwid2FidFwiIiwid2VicGFjazovL3dlYi1hc20taml0L3dlYnBhY2svYm9vdHN0cmFwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJ1biB9IGZyb20gJy4vcnVubmVyJztcblxuXG5mdW5jdGlvbiB3ZWJTdGFydCgpIHtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGRpc3BsYXlTZXJ2ZXIoYXJnOiBzdHJpbmcpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiYXJnIGluIGRpc3BsYXlTZXJ2ZXJcIiwgYXJnKVxuICAgICAgY29uc3QgZWx0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInByZVwiKTtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VydmVyQ29tcGlsZU91dHB1dFwiKS5hcHBlbmRDaGlsZChlbHQpO1xuICAgICAgZWx0LmlubmVyVGV4dCA9IGFyZztcbiAgICB9XG4gICAgZnVuY3Rpb24gZGlzcGxheVNlcnZlcmxlc3MoYXJnOnN0cmluZykge1xuICAgICAgY29uc29sZS5sb2coXCJhcmcgaW4gZGlzcGxheVNlcnZlcmxlc3NcIiwgYXJnKVxuICAgICAgY29uc3QgZWx0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInByZVwiKTtcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2VydmVybGVzc0NvbXBpbGVPdXRwdXRcIikuYXBwZW5kQ2hpbGQoZWx0KTtcbiAgICAgIGVsdC5pbm5lclRleHQgPSBhcmc7XG4gICAgfVxuICAgIHZhciBpbXBvcnRPYmplY3RTZXJ2ZXIgPSB7aW1wb3J0T2JqZWN0OntcbiAgICAgIGltcG9ydHM6IHtcbiAgICAgICAgcHJpbnQ6IChhcmc6IGFueSkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9nZ2luZyBmcm9tIFdBU006IFwiLCBhcmcpO1xuICAgICAgICAgIGNvbnN0IGVsdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwcmVcIik7XG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvdXRwdXRcIikuYXBwZW5kQ2hpbGQoZWx0KTtcbiAgICAgICAgICBlbHQuaW5uZXJUZXh0ID0gYXJnO1xuICAgICAgICAgIHJldHVybiBhcmc7XG4gICAgICAgIH0sXG4gICAgICAgIHByaW50X251bTogKGFyZzogYW55KSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJMb2dnaW5nIGZyb20gV0FTTTogXCIsIGFyZyk7XG4gICAgICAgICAgZGlzcGxheVNlcnZlcihTdHJpbmcoYXJnKSk7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIHByaW50X2Jvb2w6IChhcmc6IGFueSkgPT4ge1xuICAgICAgICAgIGlmIChhcmcgPT09IDApIHsgZGlzcGxheVNlcnZlcihcIkZhbHNlXCIpOyB9XG4gICAgICAgICAgZWxzZSB7IGRpc3BsYXlTZXJ2ZXIoXCJUcnVlXCIpOyB9XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIHByaW50X25vbmU6IChhcmc6IGFueSkgPT4ge1xuICAgICAgICAgIGRpc3BsYXlTZXJ2ZXIoXCJOb25lXCIpO1xuICAgICAgICAgIHJldHVybiBhcmc7XG4gICAgICAgIH0sXG4gICAgICAgIGFiczogTWF0aC5hYnMsXG4gICAgICAgIG1heDogTWF0aC5tYXgsXG4gICAgICAgIG1pbjogTWF0aC5taW4sXG4gICAgICAgIHBvdzogTWF0aC5wb3csXG4gICAgICB9LFxuICAgIH19O1xuXG4gICAgdmFyIGltcG9ydE9iamVjdFNlcnZlcmxlc3MgPSB7aW1wb3J0T2JqZWN0OntcbiAgICAgIGltcG9ydHM6IHtcbiAgICAgICAgcHJpbnQ6IChhcmc6IGFueSkgPT4ge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiTG9nZ2luZyBmcm9tIFdBU006IFwiLCBhcmcpO1xuICAgICAgICAgIGNvbnN0IGVsdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwcmVcIik7XG4gICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJvdXRwdXRcIikuYXBwZW5kQ2hpbGQoZWx0KTtcbiAgICAgICAgICBlbHQuaW5uZXJUZXh0ID0gYXJnO1xuICAgICAgICAgIHJldHVybiBhcmc7XG4gICAgICAgIH0sXG4gICAgICAgIHByaW50X251bTogKGFyZzogYW55KSA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJMb2dnaW5nIGZyb20gV0FTTTogXCIsIGFyZyk7XG4gICAgICAgICAgZGlzcGxheVNlcnZlcmxlc3MoU3RyaW5nKGFyZykpO1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBwcmludF9ib29sOiAoYXJnOiBhbnkpID0+IHtcbiAgICAgICAgICBpZiAoYXJnID09PSAwKSB7IGRpc3BsYXlTZXJ2ZXIoXCJGYWxzZVwiKTsgfVxuICAgICAgICAgIGVsc2UgeyBkaXNwbGF5U2VydmVybGVzcyhcIlRydWVcIik7IH1cbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgcHJpbnRfbm9uZTogKGFyZzogYW55KSA9PiB7XG4gICAgICAgICAgZGlzcGxheVNlcnZlcmxlc3MoXCJOb25lXCIpO1xuICAgICAgICAgIHJldHVybiBhcmc7XG4gICAgICAgIH0sXG4gICAgICAgIGFiczogTWF0aC5hYnMsXG4gICAgICAgIG1heDogTWF0aC5tYXgsXG4gICAgICAgIG1pbjogTWF0aC5taW4sXG4gICAgICAgIHBvdzogTWF0aC5wb3csXG4gICAgICB9LFxuICAgIH19O1xuXG4gICAgZnVuY3Rpb24gcmVuZGVyUmVzdWx0KHJlc3VsdDogYW55KTogdm9pZCB7XG4gICAgICBpZiAocmVzdWx0LnNlcnZlcikge1xuICAgICAgICBjb25zdCBlbHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicHJlXCIpO1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNlcnZlckNvbXBpbGVPdXRwdXRcIikuYXBwZW5kQ2hpbGQoZWx0KTtcbiAgICAgICAgZWx0LmlubmVyVGV4dCA9IHJlc3VsdC5zZXJ2ZXI7XG4gICAgICB9XG4gICAgICBpZiAocmVzdWx0LnNlcnZlcmxlc3MpIHtcbiAgICAgICAgY29uc3QgZWx0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInByZVwiKTtcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzZXJ2ZXJsZXNzQ29tcGlsZU91dHB1dFwiKS5hcHBlbmRDaGlsZChlbHQpO1xuICAgICAgICBlbHQuaW5uZXJUZXh0ID0gcmVzdWx0LnNlcnZlcmxlc3M7XG4gICAgICB9XG4gICAgICBjb25zdCBjb21wYXJpc29uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21wYXJpc29uXCIpO1xuICAgICAgY29tcGFyaXNvbi5pbm5lckhUTUwgPSBcIjxzdHJvbmc+IEZpZGVsaXR5IHZlcmlmaWNhdGlvbjogPC9zdHJvbmc+XCIgKyAocmVzdWx0LmNvbXBhcmU/YDxzcGFuIHN0eWxlPVwiY29sb3I6Z3JlZW5cIj5QYXNzZWQ8L3NwYW4+YDpgPHNwYW4gc3R5bGU9XCJjb2xvcjpyZWRcIj5GYWlsZWQ8L3NwYW4+YCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVuZGVyRXJyb3IocmVzdWx0OiBhbnkpOiB2b2lkIHtcbiAgICAgIGNvbnN0IGVsdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwcmVcIik7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm91dHB1dFwiKS5hcHBlbmRDaGlsZChlbHQpO1xuICAgICAgZWx0LnNldEF0dHJpYnV0ZShcInN0eWxlXCIsIFwiY29sb3I6IHJlZFwiKTtcbiAgICAgIGVsdC5pbm5lclRleHQgPSBTdHJpbmcocmVzdWx0KTtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJ1blwiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgIGNvbnN0IHNvdXJjZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidXNlci1jb2RlXCIpIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XG4gICAgICBydW4oc291cmNlLnZhbHVlLCBpbXBvcnRPYmplY3RTZXJ2ZXIsIGltcG9ydE9iamVjdFNlcnZlcmxlc3MpLnRoZW4oKHIpID0+IHsgcmVuZGVyUmVzdWx0KHIpOyBjb25zb2xlLmxvZyhcInJ1biBmaW5pc2hlZFwiKSB9KVxuICAgICAgICAuY2F0Y2goKGUpID0+IHsgcmVuZGVyRXJyb3IoZSk7IGNvbnNvbGUubG9nKFwicnVuIGZhaWxlZFwiLCBlKSB9KTs7XG4gICAgfSk7XG4gICAgY29uc3QgdGV4dGFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwidGV4dGFyZWFcIik7XG5cbiAgICB0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xuICAgICAgaWYgKGUua2V5Q29kZSA9PT0gOSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgdGV4dGFyZWEuc2V0UmFuZ2VUZXh0KFxuICAgICAgICAgIFwiICBcIixcbiAgICAgICAgICB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCxcbiAgICAgICAgICB0ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCxcbiAgICAgICAgICBcImVuZFwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuXG53ZWJTdGFydCgpO1xuIiwiLy8gVGhpcyBpcyBhIG1hc2h1cCBvZiB0dXRvcmlhbHMgZnJvbTpcbi8vXG4vLyAtIGh0dHBzOi8vZ2l0aHViLmNvbS9Bc3NlbWJseVNjcmlwdC93YWJ0LmpzL1xuLy8gLSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYkFzc2VtYmx5L1VzaW5nX3RoZV9KYXZhU2NyaXB0X0FQSVxuXG4vLyBpbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xuaW1wb3J0IHdhYnQgZnJvbSAnd2FidCc7XG5cbi8vIE5PVEUoam9lKTogVGhpcyBpcyBhIGhhY2sgdG8gZ2V0IHRoZSBDTEkgUmVwbCB0byBydW4uIFdBQlQgcmVnaXN0ZXJzIGEgZ2xvYmFsXG4vLyB1bmNhdWdodCBleG4gaGFuZGxlciwgYW5kIHRoaXMgaXMgbm90IGFsbG93ZWQgd2hlbiBydW5uaW5nIHRoZSBSRVBMXG4vLyAoaHR0cHM6Ly9ub2RlanMub3JnL2FwaS9yZXBsLmh0bWwjcmVwbF9nbG9iYWxfdW5jYXVnaHRfZXhjZXB0aW9ucykuIE5vIHJlYXNvblxuLy8gaXMgZ2l2ZW4gZm9yIHRoaXMgaW4gdGhlIGRvY3MgcGFnZSwgYW5kIEkgaGF2ZW4ndCBzcGVudCB0aW1lIG9uIHRoZSBkb21haW5cbi8vIG1vZHVsZSB0byBmaWd1cmUgb3V0IHdoYXQncyBnb2luZyBvbiBoZXJlLiBJdCBkb2Vzbid0IHNlZW0gY3JpdGljYWwgZm9yIFdBQlRcbi8vIHRvIGhhdmUgdGhpcyBzdXBwb3J0LCBzbyB3ZSBwYXRjaCBpdCBhd2F5LlxuaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gIGNvbnN0IG9sZFByb2Nlc3NPbiA9IHByb2Nlc3Mub247XG4gIHByb2Nlc3Mub24gPSAoLi4uYXJnczogYW55KTogYW55ID0+IHtcbiAgICBpZiAoYXJnc1swXSA9PT0gXCJ1bmNhdWdodEV4Y2VwdGlvblwiKSB7IHJldHVybjsgfVxuICAgIGVsc2UgeyByZXR1cm4gb2xkUHJvY2Vzc09uLmFwcGx5KHByb2Nlc3MsIGFyZ3MpOyB9XG4gIH07XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGV4ZWNXYXNtKHdhc21Tb3VyY2U6IHN0cmluZywgY29uZmlnOmFueSApe1xuICBjb25zdCB3YWJ0SW50ZXJmYWNlID0gYXdhaXQgd2FidCgpO1xuICBjb25zdCBpbXBvcnRPYmplY3QgPSBjb25maWcuaW1wb3J0T2JqZWN0O1xuICBjb25zdCBteU1vZHVsZSA9IHdhYnRJbnRlcmZhY2UucGFyc2VXYXQoXCJ0ZXN0LndhdFwiLCB3YXNtU291cmNlKTtcbiAgdmFyIGFzQmluYXJ5ID0gbXlNb2R1bGUudG9CaW5hcnkoe30pO1xuICB2YXIgd2FzbU1vZHVsZSA9IGF3YWl0IFdlYkFzc2VtYmx5Lmluc3RhbnRpYXRlKGFzQmluYXJ5LmJ1ZmZlciwgaW1wb3J0T2JqZWN0KTtcbiAgY29uc3QgcmVzdWx0ID0gKHdhc21Nb2R1bGUuaW5zdGFuY2UuZXhwb3J0cy5leHBvcnRlZF9mdW5jIGFzIGFueSkoKTtcbiAgY29uc29sZS5sb2coXCJNZW1vcnlcIiwgd2FzbU1vZHVsZS5pbnN0YW5jZS5leHBvcnRzLm1lbW9yeSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBydW4oc291cmNlOiBzdHJpbmcsIHNlcnZlckNvbmZpZzogYW55LCBzZXJ2ZXJsZXNzQ29uZmlnOiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICBjb25zdCBleGVjSW5wdXQgPSB7XG4gICAgaW5wdXQ6IEpTT04uc3RyaW5naWZ5KHsgcHJvZ3JhbTogc291cmNlIH0pLFxuICAgIHN0YXRlTWFjaGluZUFybjogXCJhcm46YXdzOnN0YXRlczp1cy13ZXN0LTI6MDc4MjEyNjAwNTQ0OnN0YXRlTWFjaGluZTpXYXRob25cIlxuICB9XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vbDA3ZW5vODE3ZS5leGVjdXRlLWFwaS51cy13ZXN0LTIuYW1hem9uYXdzLmNvbS9kZWx0YS9leGVjdXRpb24nLCB7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoZXhlY0lucHV0KSxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgfVxuICB9KTtcbiAgY29uc3Qgc2VydmVybGVzc1Jlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgY29uc29sZS5sb2coXCJleGVjdXRpb24gb3V0cHV0XCIsIHNlcnZlcmxlc3NSZXN1bHQpO1xuICBjb25zdCBkZXRhaWxzSW5wdXQgPSB7XG4gICAgZXhlY3V0aW9uQXJuOiBzZXJ2ZXJsZXNzUmVzdWx0LmV4ZWN1dGlvbkFyblxuICB9XG4gIHZhciBleGVjRGV0YWlsc1Jlc3VsdDtcbiAgZG8ge1xuICAgIGNvbnN0IGV4ZWNEZXRhaWxzID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vbDA3ZW5vODE3ZS5leGVjdXRlLWFwaS51cy13ZXN0LTIuYW1hem9uYXdzLmNvbS9kZWx0YS9kZXNjJywge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkZXRhaWxzSW5wdXQpLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICB9XG4gICAgfSk7XG4gICAgZXhlY0RldGFpbHNSZXN1bHQgPSBhd2FpdCBleGVjRGV0YWlscy5qc29uKCk7XG4gIH0gd2hpbGUgKGV4ZWNEZXRhaWxzUmVzdWx0LnN0YXR1cyA9PT0gXCJSVU5OSU5HXCIpO1xuICBjb25zdCB3YXNtU291cmNlOnN0cmluZyA9IEpTT04ucGFyc2UoZXhlY0RldGFpbHNSZXN1bHQub3V0cHV0KTtcbiAgY29uc29sZS5sb2coXCJGaW5hbCBXYXNtIGNvZGU6XFxuXCIgKyB3YXNtU291cmNlKTtcbiAgY29uc3Qgc2VydmVybGVzc091dHB1dCA9IGF3YWl0IGV4ZWNXYXNtKHdhc21Tb3VyY2UsIHNlcnZlcmxlc3NDb25maWcpO1xuICAvLyByZXR1cm4gcmVzdWx0O1xuICBjb25zdCBzZXJ2ZXJJbnB1dCA9IHtcbiAgICBwcm9ncmFtOiBzb3VyY2VcbiAgfVxuICBjb25zdCBzZXJ2ZXJSZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwOi8vZWMyLTUyLTM5LTE2OC05LnVzLXdlc3QtMi5jb21wdXRlLmFtYXpvbmF3cy5jb206MzAwMC8nLCB7XG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkoc2VydmVySW5wdXQpLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9XG4gIH0pO1xuICBjb25zdCBzZXJ2ZXJSZXN1bHQgPSBhd2FpdCBzZXJ2ZXJSZXNwb25zZS50ZXh0KCk7XG4gIGNvbnN0IHNlcnZlck91dHB1dCA9IGF3YWl0IGV4ZWNXYXNtKHNlcnZlclJlc3VsdCwgc2VydmVyQ29uZmlnKTtcbiAgcmV0dXJuIHsgc2VydmVyOiBzZXJ2ZXJPdXRwdXQsIHNlcnZlcmxlc3M6IHNlcnZlcmxlc3NPdXRwdXQsIGNvbXBhcmU6IHNlcnZlcmxlc3NPdXRwdXQgPT09IHNlcnZlck91dHB1dCB9O1xufVxuIiwibW9kdWxlLmV4cG9ydHMgPSB3YWJ0OyIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iXSwibmFtZXMiOlsicHJvY2VzcyIsIm9uIiwiYXJncyIsImFwcGx5IiwiZXhlY1dhc20iLCJ3YXNtU291cmNlIiwiY29uZmlnIiwid2FidEludGVyZmFjZSIsImltcG9ydE9iamVjdCIsIm15TW9kdWxlIiwicGFyc2VXYXQiLCJhc0JpbmFyeSIsInRvQmluYXJ5IiwiV2ViQXNzZW1ibHkiLCJpbnN0YW50aWF0ZSIsImJ1ZmZlciIsIndhc21Nb2R1bGUiLCJyZXN1bHQiLCJpbnN0YW5jZSIsImV4cG9ydHMiLCJleHBvcnRlZF9mdW5jIiwiY29uc29sZSIsImxvZyIsIm1lbW9yeSIsInNvdXJjZSIsInNlcnZlckNvbmZpZyIsInNlcnZlcmxlc3NDb25maWciLCJleGVjSW5wdXQiLCJpbnB1dCIsIkpTT04iLCJzdHJpbmdpZnkiLCJwcm9ncmFtIiwic3RhdGVNYWNoaW5lQXJuIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiaGVhZGVycyIsImpzb24iLCJzZXJ2ZXJsZXNzUmVzdWx0IiwiZGV0YWlsc0lucHV0IiwiZXhlY3V0aW9uQXJuIiwiZXhlY0RldGFpbHNSZXN1bHQiLCJzdGF0dXMiLCJwYXJzZSIsIm91dHB1dCIsInNlcnZlcmxlc3NPdXRwdXQiLCJzZXJ2ZXJJbnB1dCIsInRleHQiLCJzZXJ2ZXIiLCJzZXJ2ZXJPdXRwdXQiLCJzZXJ2ZXJsZXNzIiwiY29tcGFyZSIsIm1vZHVsZSIsIndhYnQiLCJfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18iLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJjYWNoZWRNb2R1bGUiLCJ1bmRlZmluZWQiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiY2FsbCIsImRvY3VtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImRpc3BsYXlTZXJ2ZXIiLCJhcmciLCJlbHQiLCJjcmVhdGVFbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJhcHBlbmRDaGlsZCIsImlubmVyVGV4dCIsImRpc3BsYXlTZXJ2ZXJsZXNzIiwiaW1wb3J0T2JqZWN0U2VydmVyIiwiaW1wb3J0cyIsInByaW50IiwicHJpbnRfbnVtIiwiU3RyaW5nIiwicHJpbnRfYm9vbCIsInByaW50X25vbmUiLCJhYnMiLCJNYXRoIiwibWF4IiwibWluIiwicG93IiwiaW1wb3J0T2JqZWN0U2VydmVybGVzcyIsImUiLCJydW4iLCJ2YWx1ZSIsInRoZW4iLCJyIiwiaW5uZXJIVE1MIiwicmVuZGVyUmVzdWx0IiwiY2F0Y2giLCJzZXRBdHRyaWJ1dGUiLCJ0ZXh0YXJlYSIsInF1ZXJ5U2VsZWN0b3IiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJzZXRSYW5nZVRleHQiLCJzZWxlY3Rpb25TdGFydCJdLCJzb3VyY2VSb290IjoiIn0=